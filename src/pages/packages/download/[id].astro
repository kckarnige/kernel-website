---
import type { Package } from "~/lib/packages";

const { id } = Astro.params;
let packages: Package[] = [];

try {
    packages = await Astro.glob("~/packages/*.json");
} catch(error) {
    packages = [];
}
const url = packages.find(pkg => pkg.id == id)?.download;

if (url) {
    return Astro.redirect(url);
} else {
    Astro.response.status = 404;
    Astro.response.statusText = "Could not find package" + id;
}
---